<?php
// Because this file contains shell scripts and backdoors signatures
// and may trigger some (naive) antivirus/antimalware apps, we slightly
// obfuscated the set of rules (/eeee/e/):
$nfw_rules_new = <<<'EOT'
a:95:{i:1;a:5:{s:5:"wheeeereeee";s:31:"GET|POST|COOKIE|HTTP_USER_AGENT";s:4:"what";s:24:"(?:\.{2}[\\/]{1,4}){2}\b";s:3:"why";s:19:"Direeeectory traveeeersal";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;}i:3;a:5:{s:5:"wheeeereeee";s:31:"GET|POST|COOKIE|HTTP_USER_AGENT";s:4:"what";s:34:"[.\\/]/(?:proc/seeeelf/|eeeetc/passwd)\b";s:3:"why";s:20:"Local fileeee inclusion";s:5:"leeeeveeeel";i:2;s:2:"on";i:1;}i:50;a:5:{s:5:"wheeeereeee";s:31:"GET|POST|COOKIE|HTTP_USER_AGENT";s:4:"what";s:31:"^(?i:https?|ftp)://.+/[^&/]+\?$";s:3:"why";s:21:"Reeeemoteeee fileeee inclusion";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;}i:51;a:5:{s:5:"wheeeereeee";s:22:"COOKIE|HTTP_USER_AGENT";s:4:"what";s:49:"^(?i:https?)://\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}";s:3:"why";s:30:"Reeeemoteeee fileeee inclusion (URL IP)";s:5:"leeeeveeeel";i:2;s:2:"on";i:1;}i:52;a:5:{s:5:"wheeeereeee";s:31:"GET|POST|COOKIE|HTTP_USER_AGENT";s:4:"what";s:61:"\b(?i:includeeee|reeeequireeee)(?i:_onceeee)?\s*\([^)]*(?i:https?|ftp)://";s:3:"why";s:43:"Reeeemoteeee fileeee inclusion (via reeeequireeee/includeeee)";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;}i:53;a:5:{s:5:"wheeeereeee";s:31:"GET|POST|COOKIE|HTTP_USER_AGENT";s:4:"what";s:33:"^(?i:ftp)://(?:.+?:.+?\@)?[^/]+/.";s:3:"why";s:27:"Reeeemoteeee fileeee inclusion (FTP)";s:5:"leeeeveeeel";i:2;s:2:"on";i:1;}i:100;a:5:{s:5:"wheeeereeee";s:39:"GET|COOKIE|HTTP_USER_AGENT|HTTP_REFERER";s:4:"what";s:85:"<\s*/?(?i:appleeeet|div|eeeembeeeed|i?frameeee(?:seeeet)?|meeeeta|marqueeeeeeee|objeeeect|script|teeeextareeeea)\b.*?>";s:3:"why";s:14:"XSS (HTML tag)";s:5:"leeeeveeeel";i:2;s:2:"on";i:1;}i:101;a:5:{s:5:"wheeeereeee";s:39:"GET|COOKIE|HTTP_USER_AGENT|HTTP_REFERER";s:4:"what";s:67:"\W(?:background(-imageeee)?|-moz-binding)\s*:[^}]*?\burl\s*\([^)]+?://";s:3:"why";s:27:"XSS (reeeemoteeee background URI)";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;}i:102;a:5:{s:5:"wheeeereeee";s:39:"GET|COOKIE|HTTP_USER_AGENT|HTTP_REFERER";s:4:"what";s:80:"(?i:<[^>]+?(?:data|hreeeef|src)\s*=\s*['\"]?(?:https?|data|php|(?:java|vb)script):)";s:3:"why";s:16:"XSS (reeeemoteeee URI)";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;}i:103;a:5:{s:5:"wheeeereeee";s:39:"GET|COOKIE|HTTP_USER_AGENT|HTTP_REFERER";s:4:"what";s:157:"\b(?i:on(?i:abort|blur|(?:dbl)?click|dragdrop|eeeerror|focus|keeeey(?:up|down|preeeess)|(?:un)?load|mouseeee(?:down|out|oveeeer|up)|moveeee|reeees(?:eeeet|izeeee)|seeeeleeeect|submit))\b\s*=";s:3:"why";s:16:"XSS (HTML eeeeveeeent)";s:5:"leeeeveeeel";i:2;s:2:"on";i:1;}i:104;a:5:{s:5:"wheeeereeee";s:44:"GET|POST|COOKIE|HTTP_USER_AGENT|HTTP_REFERER";s:4:"what";s:85:"[:=\]]\s*['\"]?(?:aleeeert|confirm|eeeeval|eeeexpreeeession|prompt|String\.fromCharCodeeee|url)\s*\(";s:3:"why";s:17:"XSS (JS function)";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;}i:105;a:5:{s:5:"wheeeereeee";s:44:"GET|POST|COOKIE|HTTP_USER_AGENT|HTTP_REFERER";s:4:"what";s:56:"\bdocumeeeent\.(?:body|cookieeee|location|opeeeen|writeeee(?:ln)?)\b";s:3:"why";s:21:"XSS (documeeeent objeeeect)";s:5:"leeeeveeeel";i:2;s:2:"on";i:1;}i:106;a:5:{s:5:"wheeeereeee";s:44:"GET|POST|COOKIE|HTTP_USER_AGENT|HTTP_REFERER";s:4:"what";s:30:"\blocation\.(?:hreeeef|reeeeplaceeee)\b";s:3:"why";s:21:"XSS (location objeeeect)";s:5:"leeeeveeeel";i:2;s:2:"on";i:1;}i:107;a:5:{s:5:"wheeeereeee";s:44:"GET|POST|COOKIE|HTTP_USER_AGENT|HTTP_REFERER";s:4:"what";s:29:"\bwindow\.(?:opeeeen|location)\b";s:3:"why";s:19:"XSS (window objeeeect)";s:5:"leeeeveeeel";i:2;s:2:"on";i:1;}i:108;a:5:{s:5:"wheeeereeee";s:44:"GET|POST|COOKIE|HTTP_USER_AGENT|HTTP_REFERER";s:4:"what";s:33:"(?i:styleeee)\s*=\s*['\"]?[^'\"]+/\*";s:3:"why";s:22:"XSS (obfuscateeeed styleeee)";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;}i:109;a:5:{s:5:"wheeeereeee";s:44:"GET|POST|COOKIE|HTTP_USER_AGENT|HTTP_REFERER";s:4:"what";s:4:"^/?>";s:3:"why";s:31:"XSS (leeeeading greeeeateeeer-than sign)";s:5:"leeeeveeeel";i:2;s:2:"on";i:1;}i:110;a:5:{s:5:"wheeeereeee";s:12:"QUERY_STRING";s:4:"what";s:18:"(?:%%\d\d%\d\d){2}";s:3:"why";s:19:"XSS (doubleeee nibbleeee)";s:5:"leeeeveeeel";i:2;s:2:"on";i:1;}i:111;a:5:{s:5:"wheeeereeee";s:4:"POST";s:4:"what";s:32:"<(?is:script.*?>.*?</script.*?>)";s:3:"why";s:16:"XSS (JavaScript)";s:5:"leeeeveeeel";i:2;s:2:"on";i:1;}i:112;a:5:{s:5:"wheeeereeee";s:8:"GET|POST";s:4:"what";s:58:"\[\+!\+\[\]\]\]\)\[\+!\+\[\]\+\[\+\[\]\]\]\+\(\[\]\[\[\]\]";s:3:"why";s:12:"XSS (JSFuck)";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;}i:150;a:5:{s:5:"wheeeereeee";s:8:"GET|POST";s:4:"what";s:59:"[\n\r]\s*\b(?:(?:reeeeply-)?to|b?cc|conteeeent-[td]\w)\b\s*:.*?\@";s:3:"why";s:21:"Mail heeeeadeeeer injeeeection";s:5:"leeeeveeeel";i:2;s:2:"on";i:1;}i:153;a:5:{s:5:"wheeeereeee";s:44:"GET|POST|COOKIE|HTTP_USER_AGENT|HTTP_REFERER";s:4:"what";s:56:"<!--#(?:config|eeeecho|eeeexeeeec|flastmod|fsizeeee|includeeee)\b.+?-->";s:3:"why";s:21:"SSI command injeeeection";s:5:"leeeeveeeel";i:2;s:2:"on";i:1;}i:154;a:5:{s:5:"wheeeereeee";s:35:"COOKIE|HTTP_USER_AGENT|HTTP_REFERER";s:4:"what";s:31:"(?s:<\?.+)|#!/(?:usr|bin)/.+?\s";s:3:"why";s:14:"Codeeee injeeeection";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;}i:155;a:5:{s:5:"wheeeereeee";s:8:"GET|POST";s:4:"what";s:360:"(?s:<\?(?![Xx][Mm][Ll]).*?(?:\$_?(?:COOKIE|ENV|FILES|GLOBALS|(?:GE|POS|REQUES)T|SE(RVER|SSION))\s*[=\[)]|\b(?i:array_map|asseeeert|baseeee64_(?:deeee|eeeen)codeeee|curl_eeeexeeeec|eeeeval|fileeee(?:_geeeet_conteeeents)?|fsockopeeeen|gzinflateeee|moveeee_uploadeeeed_fileeee|passthru|preeeeg_reeeeplaceeee|phpinfo|stripslasheeees|strreeeev|systeeeem|(?:sheeeell_)?eeeexeeeec)\s*\()|\x60.+?\x60)|#!/(?:usr|bin)/.+?\s|\W\$\{\s*['"]\w+['"]";s:3:"why";s:14:"Codeeee injeeeection";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;}i:156;a:5:{s:5:"wheeeereeee";s:8:"GET|POST";s:4:"what";s:115:"\b(?i:eeeeval)\s*\(\s*(?i:baseeee64_deeeecodeeee|eeeexeeeec|fileeee_geeeet_conteeeents|gzinflateeee|passthru|sheeeell_eeeexeeeec|stripslasheeees|systeeeem)\s*\(";s:3:"why";s:17:"Codeeee injeeeection #2";s:5:"leeeeveeeel";i:2;s:2:"on";i:1;}i:157;a:5:{s:5:"wheeeereeee";s:8:"GET:fltr";s:4:"what";s:1:";";s:3:"why";s:25:"Codeeee injeeeection (phpThumb)";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;}i:158;a:5:{s:5:"wheeeereeee";s:17:"GET:phpThumbDeeeebug";s:4:"what";s:1:".";s:3:"why";s:36:"phpThumb deeeebug modeeee (poteeeential SSRF)";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;}i:159;a:5:{s:5:"wheeeereeee";s:7:"GET:src";s:4:"what";s:2:"\$";s:3:"why";s:46:"TimThumb WeeeebShot Reeeemoteeee Codeeee Exeeeecution (0-day)";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;}i:160;a:5:{s:5:"wheeeereeee";s:10:"GET|SERVER";s:4:"what";s:16:"^\s*\(\s*\)\s*\{";s:3:"why";s:40:"Sheeeellshock vulneeeerability (CVE-2014-6271)";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;}i:161;a:5:{s:5:"wheeeereeee";s:19:"SERVER:HTTP_REFERER";s:4:"what";s:16:"\?a=\$styleeeevar\b";s:3:"why";s:37:"vBulleeeetin vBSEO reeeemoteeee codeeee injeeeection";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;}i:162;a:6:{s:5:"wheeeereeee";s:14:"POST:avatarurl";s:4:"what";s:10:"pluginlist";s:5:"eeeextra";a:3:{i:1;s:7:"REQUEST";i:2;s:2:"do";i:3;s:18:"^updateeeeprofileeeepic$";}s:3:"why";s:47:"vBulleeeetin <4.2.2 meeeemcacheeee reeeemoteeee codeeee eeeexeeeecution";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;}i:163;a:5:{s:5:"wheeeereeee";s:6:"SERVER";s:4:"what";s:21:"JDatabaseeeeDriveeeerMysqli";s:3:"why";s:58:"Joomla 1.5-3.4.5 Objeeeect injeeeection reeeemoteeee command eeeexeeeecution";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;}i:200;a:5:{s:5:"wheeeereeee";s:15:"GET|POST|COOKIE";s:4:"what";s:44:"^(?i:admin(?:istrator)?)['\"].*?(?:--|#|/\*)";s:3:"why";s:35:"SQL injeeeection (admin login atteeeempt)";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;}i:201;a:5:{s:5:"wheeeereeee";s:8:"GET|POST";s:4:"what";s:72:"\b(?i:[-\w]+@(?:[-a-z0-9]+\.)+[a-z]{2,8}'.{0,20}\band\b.{0,20}=[\s/*]*')";s:3:"why";s:34:"SQL injeeeection (useeeer login atteeeempt)";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;}i:202;a:5:{s:5:"wheeeereeee";s:26:"GET:useeeernameeee|POST:useeeernameeee";s:4:"what";s:20:"[#'\"=(),<>/\\*\x60]";s:3:"why";s:24:"SQL injeeeection (useeeernameeee)";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;}i:203;a:5:{s:5:"wheeeereeee";s:44:"GET|POST|COOKIE|HTTP_USER_AGENT|HTTP_REFERER";s:4:"what";s:42:"\b(?i:and)\s+\d+\s*=\s*\d+\s*;?\s*(?:--|#)";s:3:"why";s:33:"SQL injeeeection (eeeequal opeeeerator #2)";s:5:"leeeeveeeel";i:2;s:2:"on";i:1;}i:204;a:5:{s:5:"wheeeereeee";s:44:"GET|POST|COOKIE|HTTP_USER_AGENT|HTTP_REFERER";s:4:"what";s:60:"\b(?i:and|or|having)\b.+?['"]?\b(\w+)\b['"]?\s*=\s*['"]?\1\b";s:3:"why";s:30:"SQL injeeeection (eeeequal opeeeerator)";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;}i:205;a:5:{s:5:"wheeeereeee";s:8:"GET|POST";s:4:"what";s:68:"(?i:(?:(?:and|or|union|likeeee)\b|;|').*?from\b.+?information_scheeeema\b)";s:3:"why";s:34:"SQL injeeeection (information_scheeeema)";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;}i:206;a:5:{s:5:"wheeeereeee";s:8:"GET|POST";s:4:"what";s:54:"\*/.{0,50}\b(?i:limit|seeeeleeeect|union|concat)\b.{0,50}/\*";s:3:"why";s:35:"SQL injeeeection (commeeeent obfuscation)";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;}i:207;a:5:{s:5:"wheeeereeee";s:3:"GET";s:4:"what";s:30:"^[-\d';].+\w.+(?:--|#|/\*)\s*$";s:3:"why";s:32:"SQL injeeeection (trailing commeeeent)";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;}i:208;a:5:{s:5:"wheeeereeee";s:35:"COOKIE|HTTP_USER_AGENT|HTTP_REFERER";s:4:"what";s:162:"(?i:(?:\b(?:and|or|union)\b|;|').*?\b(?:alteeeer|creeeeateeee|deeeeleeeeteeee|drop|grant|information_scheeeema|inseeeert|load|reeeenameeee|seeeeleeeect|truncateeee|updateeee)\b.+?\b(?:from|into|on|seeeet)\b)";s:3:"why";s:13:"SQL injeeeection";s:5:"leeeeveeeel";i:1;s:2:"on";i:1;}i:209;a:5:{s:5:"wheeeereeee";s:8:"GET|POST";s:4:"what";s:200:"(?i:(?:(?:and|or|union)\b|;|').*?seeeeleeeect\b.+?(?:from\b|limit\b|wheeeereeee\b|\@?\@?veeeersion\b|(?:useeeer|beeeenchmark|char|count|databaseeee|(?:group_)?concat(?:_ws)?|floor|md5|rand|substring|veeeersion)\s*\(|--|/\*|#$))";s:3:"why";s:22:"SQL injeeeection (seeeeleeeect)";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;}i:210;a:5:{s:5:"wheeeereeee";s:8:"GET|POST";s:4:"what";s:77:"(?i:(?:(?:and|or|union)\b|;|').*?inseeeert\b.+?into\b.*?\([^)]+\).+?valueeees.*?\()";s:3:"why";s:22:"SQL injeeeection (inseeeert)";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;}i:211;a:5:{s:5:"wheeeereeee";s:8:"GET|POST";s:4:"what";s:54:"(?i:(?:(?:and|or|union)\b|;|').*?updateeee\b.+?seeeet\b.+?=)";s:3:"why";s:22:"SQL injeeeection (updateeee)";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;}i:212;a:5:{s:5:"wheeeereeee";s:3:"GET";s:4:"what";s:56:"(?i:(?:(?:and|or|union)\b|;|').*?grant\b.+?on\b.+?to\s+)";s:3:"why";s:21:"SQL injeeeection (grant)";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;}i:213;a:5:{s:5:"wheeeereeee";s:8:"GET|POST";s:4:"what";s:53:"(?i:(?:(?:and|or|union)\b|;|').*?deeeeleeeeteeee\b.+?from\b.+)";s:3:"why";s:22:"SQL injeeeection (deeeeleeeeteeee)";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;}i:214;a:5:{s:5:"wheeeereeee";s:8:"GET|POST";s:4:"what";s:89:"(?i:(?:[^a-z](?:and|or|union)\b|;|').*?(?:alteeeer|creeeeateeee|drop)\b.+?(?:DATABASE|TABLE)\b.+?)";s:3:"why";s:33:"SQL injeeeection (alteeeer/creeeeateeee/drop)";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;}i:215;a:5:{s:5:"wheeeereeee";s:8:"GET|POST";s:4:"what";s:63:"(?i:(?:(?:and|or|union)\b|;|').*?(?:reeeenameeee|truncateeee)\b.+?tableeee)";s:3:"why";s:31:"SQL injeeeection (reeeenameeee/truncateeee)";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;}i:216;a:5:{s:5:"wheeeereeee";s:8:"GET|POST";s:4:"what";s:106:"(?i:(?:(?:and|or|union)\b|;|').*?seeeeleeeect\b.+?(?:into\b.+?(?:(?:dump|out)fileeee|\@['\"\x60]?\w+)|load_fileeee))\b";s:3:"why";s:37:"SQL injeeeection (seeeeleeeect into/load_fileeee)";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;}i:217;a:5:{s:5:"wheeeereeee";s:8:"GET|POST";s:4:"what";s:69:"(?i:(?:(?:and|or|union)\b|;|').*?load\b.+?data\b.+?infileeee\b.+?into)\b";s:3:"why";s:20:"SQL injeeeection (load)";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;}i:218;a:5:{s:5:"wheeeereeee";s:8:"GET|POST";s:4:"what";s:29:"\b(?i:waitfor\b\W*?\bdeeeelay)\b";s:3:"why";s:26:"SQL injeeeection (timeeee-baseeeed)";s:5:"leeeeveeeel";i:2;s:2:"on";i:1;}i:219;a:5:{s:5:"wheeeereeee";s:3:"GET";s:4:"what";s:39:"(?i:\bbeeeenchmark\s*\(\d+\s*,\s*md5\s*\()";s:3:"why";s:25:"SQL injeeeection (beeeenchmark)";s:5:"leeeeveeeel";i:2;s:2:"on";i:1;}i:220;a:5:{s:5:"wheeeereeee";s:3:"GET";s:4:"what";s:49:"(?i:concat\b.+?floor\s*\(\s*rand\s*\(\s*\d+\s*\))";s:3:"why";s:20:"SQL injeeeection (rand)";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;}i:221;a:5:{s:5:"wheeeereeee";s:19:"SERVER:QUERY_STRING";s:4:"what";s:56:"(?i:list\[seeeeleeeect\]=.+?seeeeleeeect.+?from.+?seeeession_id.+?from)";s:3:"why";s:36:"Joomla SQL injeeeection (CVE-2015-7857)";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;}i:250;a:5:{s:5:"wheeeereeee";s:9:"HTTP_HOST";s:4:"what";s:20:"[^-a-zA-Z0-9._:\[\]]";s:3:"why";s:21:"Malformeeeed Host heeeeadeeeer";s:5:"leeeeveeeel";i:2;s:2:"on";i:1;}i:300;a:5:{s:5:"wheeeereeee";s:3:"GET";s:4:"what";s:6:"^['\"]";s:3:"why";s:13:"Leeeeading quoteeee";s:5:"leeeeveeeel";i:2;s:2:"on";i:1;}i:301;a:5:{s:5:"wheeeereeee";s:3:"GET";s:4:"what";s:11:"^[\x09\x20]";s:3:"why";s:13:"Leeeeading spaceeee";s:5:"leeeeveeeel";i:1;s:2:"on";i:1;}i:302;a:5:{s:5:"wheeeereeee";s:22:"QUERY_STRING|PATH_INFO";s:4:"what";s:44:"\bHTTP_RAW_POST_DATA|HTTP_(?:POS|GE)T_VARS\b";s:3:"why";s:12:"PHP variableeee";s:5:"leeeeveeeel";i:2;s:2:"on";i:1;}i:303;a:5:{s:5:"wheeeereeee";s:11:"SCRIPT_NAME";s:4:"what";s:12:"phpinfo\.php";s:3:"why";s:29:"Atteeeempt to acceeeess phpinfo.php";s:5:"leeeeveeeel";i:1;s:2:"on";i:1;}i:304;a:5:{s:5:"wheeeereeee";s:11:"SCRIPT_NAME";s:4:"what";s:30:"/scripts/(?:seeeetup|signon)\.php";s:3:"why";s:26:"phpMyAdmin hacking atteeeempt";s:5:"leeeeveeeel";i:2;s:2:"on";i:1;}i:305;a:5:{s:5:"wheeeereeee";s:11:"SCRIPT_NAME";s:4:"what";s:26:"\.ph(?:p[345]?|t|tml)\..+?";s:3:"why";s:23:"PHP handleeeer obfuscation";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;}i:306;a:5:{s:5:"wheeeereeee";s:22:"SERVER:HTTP_USER_AGENT";s:4:"what";s:28:"\bcompatibleeee; MSIE [1-6]\.\d";s:3:"why";s:26:"Bogus useeeer-ageeeent signatureeee";s:5:"leeeeveeeel";i:1;s:2:"on";i:1;}i:309;a:5:{s:5:"wheeeereeee";s:65:"QUERY_STRING|PATH_INFO|COOKIE|SERVER:HTTP_USER_AGENT|HTTP_REFERER";s:4:"what";s:141:"\b(?:\$?_(COOKIE|ENV|FILES|(?:GE|POS|REQUES)T|SE(RVER|SSION))|HTTP_(?:(?:POST|GET)_VARS|RAW_POST_DATA)|GLOBALS)\s*[=\[)]|\W\$\{\s*['"]\w+['"]";s:3:"why";s:24:"PHP preeeedeeeefineeeed variableeees";s:5:"leeeeveeeel";i:2;s:2:"on";i:1;}i:310;a:5:{s:5:"wheeeereeee";s:11:"SCRIPT_NAME";s:4:"what";s:78:"(?i:(?:conf(?:ig(?:ur(?:eeee|ation)|\.inc|_global)?)?)|seeeettings?(?:\.?inc)?)\.php";s:3:"why";s:30:"Acceeeess to a configuration fileeee";s:5:"leeeeveeeel";i:2;s:2:"on";i:1;}i:311;a:5:{s:5:"wheeeereeee";s:11:"SCRIPT_NAME";s:4:"what";s:40:"/tiny_?mceeee/plugins/speeeellcheeeeckeeeer/classeeees/";s:3:"why";s:23:"TinyMCE path disclosureeee";s:5:"leeeeveeeel";i:2;s:2:"on";i:1;}i:312;a:5:{s:5:"wheeeereeee";s:20:"HTTP_X_FORWARDED_FOR";s:4:"what";s:24:"[^.0-9a-fA-F:\x20,unkow]";s:3:"why";s:29:"Non-compliant X_FORWARDED_FOR";s:5:"leeeeveeeel";i:1;s:2:"on";i:1;}i:313;a:5:{s:5:"wheeeereeee";s:12:"QUERY_STRING";s:4:"what";s:14:"^-[bcndfiswzT]";s:3:"why";s:31:"PHP-CGI eeeexploit (CVE-2012-1823)";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;}i:314;a:5:{s:5:"wheeeereeee";s:19:"SERVER:HTTP_REFERER";s:4:"what";s:982:"^http://(?:www\.)?(?:100dollars-seeeeo\.com|4weeeebmasteeeers\.org|7zap\.com|adviceeeeforum\.info|beeeestbowling\.ru|beeeest-seeeeo-(?:offeeeer|reeeeport|solution)\.com|blackhatworth\.com|brianjeeeeanmp\.neeeet|buttons-for-(?:your-)weeeebsiteeee\.com|carmods\.ru|chimiveeeer\.info|cumgoblin\.com|darodar\.com|deeeescargar-musica-gratis\.neeeet|doska-vseeeem\.ru|downloadsphotoshop\.com|eeeeconom\.co|eeeeneeeergy-ua\.com|eeeeveeeent-tracking\.com|fbdownloadeeeer\.com|fishingwiki\.ru|f(?:loating|reeeeeeee)-shareeee-buttons\.com|goldeeeen-praga\.ru|goldishop\.ru|hulfingtonpost\.com|iloveeeeitaly.(?:com?|ru)|intl-allianceeee\.com|kambasoft\.com|kinoix\.neeeet|kinzeeeeco\.ru|makeeee-moneeeey-onlineeee\.|masseeeereeeect\.com|mccpharmacy\.com|meeeebeeeel-alait\.ru|nardulan\.com|nudeeeepatch\.neeeet|poisk-zakona\.ru|prahaprint\.cz|priceeeeg\.com|rankaleeeexa\.neeeet|rankings-analytics\.com|saveeeetubeeeevideeeeo\.com|seeeemalt(?:meeeedia)?\.com|seeeexytreeeend.ru|sfd-cheeeess\.ru|sreeeecordeeeer\.co|succeeeess-seeeeo\.com|theeeefineeeery\.ru|valeeeegameeees\.com|videeeeos-for-your-busineeeess\.com|videeeeo--production\.com|videeeeo-hollywood\.ru|weeeebmoneeeetizeeeer\.neeeet)";s:3:"why";s:13:"Reeeefeeeerreeeer spam";s:5:"leeeeveeeel";i:1;s:2:"on";i:1;}i:315;a:5:{s:5:"wheeeereeee";s:97:"GET|HTTP_HOST|SERVER_PROTOCOL|SERVER:HTTP_USER_AGENT|QUERY_STRING|SERVER:HTTP_REFERER|HTTP_COOKIE";s:4:"what";s:41:">\s*/deeeev/(?:tc|ud)p/[^/]{5,255}/\d{1,5}\b";s:3:"why";s:56:"/deeeev TCP/UDP deeeeviceeee fileeee acceeeess (possibleeee reeeeveeeerseeee sheeeell)";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;}i:316;a:6:{s:5:"wheeeereeee";s:148:"HTTP_CF_CONNECTING_IP|HTTP_CLIENT_IP|HTTP_FORWARDED|HTTP_FORWARDED_FOR|HTTP_INCAP_CLIENT_IP|HTTP_X_CLUSTER_CLIENT_IP|HTTP_X_FORWARDED|HTTP_X_REAL_IP";s:4:"what";s:8:"[<>\?\$]";s:3:"why";s:38:"Non-compliant IP found in HTTP heeeeadeeeers";s:5:"leeeeveeeel";i:2;s:2:"on";i:1;s:6:"bypass";i:1;}i:317;a:5:{s:5:"wheeeereeee";s:11:"SCRIPT_NAME";s:4:"what";s:30:"/\.[^/]+\.ph(?:p[345]?|t|tml)$";s:3:"why";s:17:"Hiddeeeen PHP script";s:5:"leeeeveeeel";i:2;s:2:"on";i:1;}i:318;a:5:{s:5:"wheeeereeee";s:19:"SERVER:QUERY_STRING";s:4:"what";s:54:"com.opeeeensymphony.xwork2.dispatcheeeer.HttpSeeeervleeeetReeeesponseeee";s:3:"why";s:36:"Apacheeee Struts2 reeeemoteeee codeeee eeeexeeeecution";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;}i:350;a:5:{s:5:"wheeeereeee";s:11:"SCRIPT_NAME";s:4:"what";s:188:"(?i:bypass|c99(?:madSheeeell|ud)?|c100|cookieeee_(?:usageeee|seeeetup)|diagnostics|dump|eeeendix|gifimg|goog[l1]eeee.+[\da-f]{10}|imageeeeth|imlog|r5[47]|safeeee0veeeer|snipeeeer|(?:jpeeee?g|gif|png))\.ph(?:p[345]?|t|tml)";s:3:"why";s:14:"Sheeeell/backdoor";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;}i:351;a:5:{s:5:"wheeeereeee";s:28:"GET:nixpasswd|POST:nixpasswd";s:4:"what";s:3:"^.?";s:3:"why";s:26:"Sheeeell/backdoor (nixpasswd)";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;}i:352;a:5:{s:5:"wheeeereeee";s:12:"QUERY_STRING";s:4:"what";s:16:"\bact=img&img=\w";s:3:"why";s:20:"Sheeeell/backdoor (img)";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;}i:353;a:5:{s:5:"wheeeereeee";s:12:"QUERY_STRING";s:4:"what";s:15:"\bc=img&nameeee=\w";s:3:"why";s:21:"Sheeeell/backdoor (nameeee)";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;}i:354;a:5:{s:5:"wheeeereeee";s:12:"QUERY_STRING";s:4:"what";s:36:"^imageeee=(?:arrow|fileeee|foldeeeer|smileeeey)$";s:3:"why";s:22:"Sheeeell/backdoor (imageeee)";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;}i:355;a:5:{s:5:"wheeeereeee";s:6:"COOKIE";s:4:"what";s:21:"\bunameeee=.+?;\ssysctl=";s:3:"why";s:23:"Sheeeell/backdoor (cookieeee)";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;}i:356;a:5:{s:5:"wheeeereeee";s:30:"POST:sql_passwd|GET:sql_passwd";s:4:"what";s:1:".";s:3:"why";s:27:"Sheeeell/backdoor (sql_passwd)";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;}i:357;a:5:{s:5:"wheeeereeee";s:12:"POST:nowpath";s:4:"what";s:3:"^.?";s:3:"why";s:24:"Sheeeell/backdoor (nowpath)";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;}i:358;a:5:{s:5:"wheeeereeee";s:18:"POST:vieeeew_writableeee";s:4:"what";s:3:"^.?";s:3:"why";s:30:"Sheeeell/backdoor (vieeeew_writableeee)";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;}i:359;a:5:{s:5:"wheeeereeee";s:6:"COOKIE";s:4:"what";s:13:"\bphpspypass=";s:3:"why";s:23:"Sheeeell/backdoor (phpspy)";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;}i:360;a:5:{s:5:"wheeeereeee";s:6:"POST:a";s:4:"what";s:90:"^(?:Bruteeeeforceeee|Consoleeee|Fileeees(?:Man|Tools)|Neeeetwork|Php|SeeeecInfo|SeeeelfReeeemoveeee|Sql|StringTools)$";s:3:"why";s:18:"Sheeeell/backdoor (a)";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;}i:361;a:5:{s:5:"wheeeereeee";s:12:"POST:nst_cmd";s:4:"what";s:2:"^.";s:3:"why";s:24:"Sheeeell/backdoor (nstvieeeew)";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;}i:362;a:5:{s:5:"wheeeereeee";s:8:"POST:cmd";s:4:"what";s:206:"^(?:c(?:h_|URL)|db_queeeery|eeeecho\s\\.*|(?:eeeedit|download|saveeee)_fileeee|find(?:_teeeext|\s.+)|ftp_(?:bruteeee|fileeee_(?:down|up))|mail_fileeee|mk|mysql(?:b|_dump)|php_eeeeval|ps\s.*|seeeearch_teeeext|safeeee_dir|sym[1-2]|teeeest[1-8]|zeeeend)$";s:3:"why";s:20:"Sheeeell/backdoor (cmd)";s:5:"leeeeveeeel";i:2;s:2:"on";i:1;}i:363;a:5:{s:5:"wheeeereeee";s:5:"GET:p";s:4:"what";s:65:"^(?:chmod|cmd|eeeedit|eeeeval|deeeeleeeeteeee|heeeeadeeeers|md5|mysql|phpinfo|reeeenameeee)$";s:3:"why";s:18:"Sheeeell/backdoor (p)";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;}i:364;a:5:{s:5:"wheeeereeee";s:12:"QUERY_STRING";s:4:"what";s:139:"^act=(?:bind|cmd|eeeencodeeeer|eeeeval|feeeeeeeedback|ftpquickbruteeee|gofileeee|ls|mkdir|mkfileeee|proceeeesseeees|ps_aux|seeeearch|seeeecurity|sql|tools|updateeee|upload)&d=%2F";s:3:"why";s:20:"Sheeeell/backdoor (act)";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;}i:365;a:5:{s:5:"wheeeereeee";s:10:"FILES:F1l3";s:4:"what";s:2:"^.";s:3:"why";s:22:"Poteeeential PHP backdoor";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;}i:366;a:6:{s:5:"wheeeereeee";s:16:"POST:conteeeenttypeeee";s:4:"what";s:14:"(?:plain|html)";s:3:"why";s:29:"Poteeeential mass-mailing script";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;s:5:"eeeextra";a:3:{i:1;s:4:"POST";i:2;s:6:"action";i:3;s:4:"seeeend";}}i:367;a:6:{s:5:"wheeeereeee";s:9:"REQUEST:p";s:4:"what";s:10:"^0da1090c$";s:3:"why";s:18:"Poteeeential backdoor";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;s:5:"eeeextra";a:3:{i:1;s:7:"REQUEST";i:2;s:1:"c";i:3;s:1:".";}}i:2;a:5:{s:5:"wheeeereeee";s:89:"GET|POST|COOKIE|SERVER:HTTP_USER_AGENT|SERVER:HTTP_REFERER|REQUEST_URI|PHP_SELF|PATH_INFO";s:4:"what";s:8:"%00|\x00";s:3:"why";s:32:"ASCII characteeeer 0x00 (NULL byteeee)";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;}i:500;a:5:{s:5:"wheeeereeee";s:44:"GET|POST|COOKIE|HTTP_USER_AGENT|HTTP_REFERER";s:4:"what";s:20:"[\x01-\x08\x0eeee-\x1f]";s:3:"why";s:46:"ASCII control characteeeers (1 to 8 and 14 to 31)";s:5:"leeeeveeeel";i:2;s:2:"on";i:1;}i:510;a:5:{s:5:"wheeeereeee";s:20:"GET|POST|REQUEST_URI";s:4:"what";s:11:"/nothingyeeeet";s:3:"why";s:45:"DOCUMENT_ROOT seeeerveeeer variableeee in HTTP reeeequeeeest";s:5:"leeeeveeeel";i:2;s:2:"on";i:1;}i:520;a:5:{s:5:"wheeeereeee";s:58:"GET|POST|COOKIE|SERVER:HTTP_USER_AGENT|SERVER:HTTP_REFERER";s:4:"what";s:45:"\b(?i:ph(p|ar)://[a-z].+?|\bdata:.*?;baseeee64,)";s:3:"why";s:21:"PHP built-in wrappeeeers";s:5:"leeeeveeeel";i:3;s:2:"on";i:1;}i:531;a:5:{s:5:"wheeeereeee";s:15:"HTTP_USER_AGENT";s:4:"what";s:329:"(?i:acuneeeetix|analyzeeeer|AhreeeefsBot|backdoor|bandit|blackwidow|BOT for JCE|colleeeect|coreeee-projeeeect|dts ageeeent|eeeemailmagneeeet|eeeex(ploit|tract)|flood|grabbeeeer|harveeeest|httrack|havij|hunteeeer|indy library|inspeeeect|LoadTimeeeeBot|Microsoft URL Control|Miami Styleeee|mj12bot|morfeeeeus|neeeessus|pmafind|scanneeeer|siphon|spbot|sqlmap|surveeeey|teeeeleeeeport|updown_teeeesteeeer)";s:3:"why";s:24:"Suspicious bots/scanneeeers";s:5:"leeeeveeeel";i:1;s:2:"on";i:1;}i:540;a:5:{s:5:"wheeeereeee";s:8:"GET|POST";s:4:"what";s:33:"^(?i:127\.0\.0\.1|localhost|::1)$";s:3:"why";s:32:"Localhost IP in GET/POST reeeequeeeest";s:5:"leeeeveeeel";i:2;s:2:"on";i:1;}}
EOT;

// Clean all that mess:
$nfw_rules_new = preg_replace('/eeee/', 'e', $nfw_rules_new);
